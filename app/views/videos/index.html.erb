<% if @videos.count > 1 %>
	<div class="centerofpage scrollable" style="top:239px;overflow:hidden;height:521px">
		<div style="width:855px; margin:auto">
			<div class="videopopup" style="display:none">
				<div id="data" style="width:430px;height:530px">
					<%= image_tag "videoholder_bg.png", :style => "position:absolute" %>
					<iframe id="videoplayer" width="371" height="371" src="" style="position:absolute;margin-top: 15px;margin-left: 15px;"></iframe>
					<h2 id="videosowner" style="text-align:center;position: absolute;margin-top: 402px;width:402px"></h2>
				</div>
			</div>	

			<% if @searchmode == true %>
			<p style="text-align:left;font-weight:bold;margin:0 0 0 25px;">
				<%= @videos.first.name %>'s Videos
			</p>
			<% end %>

			<div class="videoholder">
				<% @videos.each do |video| %>
					<div class="smallvideoframe bgcolorgreen shadowsmall" style="margin-right:15px;margin-top:15px">

						<a class="fancybox" href="#data" onclick="SetIframe('<%= video.url%>áá<%= video.name%>áá<%= video.id %>')">
							<%= image_tag video.thumbnail_image_url, :style => "width:180px" %>
						</a>
						<p><%= video.name[0..20] %></p>

						<div id="fb-root"></div>
						<div id="<%= video.id %>" class="fb-like" data-href="<%= video.shareurl%>" data-layout="button" data-action="like" data-ref="test" data-show-faces="true" data-share="true" data-count="none"></div>


						<a href="https://twitter.com/share" class="twitter-share-button" data-lang="en" data-count="none" data-url="<%= video.shareurl%>">Tweet</a>					
					
					</div>
				<% end %>


				<script>
				
				function SetIframe(x)
				{
					$("[id*='clone']").remove();

					var split = x.split('áá');
					$('#videoplayer').attr('src', split[0]);
					$('#videosowner').html('@'+split[1]);

					var i = 0;

				    var original = document.getElementById(split[2]);
				    var clone = original.cloneNode(true); // "deep" clone
				    
				    clone.id = "clone" + ++i; // there can only be one element with an ID
				    clone.style.marginLeft = "153px";
				    clone.style.marginTop = "460px";
				    
			    	$('#data').append(clone);

				}

				
				$(document).ready(function() {
				  $("a.fancybox").fancybox({ 
				  	afterClose: function() { $('#videoplayer').attr('src', "")	},
				  	closeBtn: false,
				  
				  });
				});

				</script>
			</div>
		</div>
	</div>
	<% if @videos.count > 8 %>
		<div class="centerofpage" style="top:752px; width:848px;font-family: 'jam_fontregular';font-size: 16px;color: yellow;text-align: center;">	
			<p style="font-family:'jam_fontregular'">SCROLL TO LOAD MORE</p>
		</div>
	<% end %>

<% elsif @videos.count == 1 %>
	<div class="centerofpage" style="width:400px;top:235px;">

		<p style="text-align:left;font-weight:bold">
			<%= @videos.first.name %>'s Videos
		</p>
		<div class="videoframe_big bgcolorgreen shadow" style="height: 418px;">
			<iframe width="350" height="350" src="<%= @videos.first.url %>"></iframe>
		</div>

		<div class="fb-like" data-href="<%= @videos.first.shareurl%>" data-layout="button" data-action="like" data-show-faces="true" data-share="true" data-count="none" style="top: -35px!important;margin-left: 140px;"></div>

	</div>
<% else %> 
	<div class="centerofpage" style="width:400px;top:235px;text-align: center;">
		<p style="text-align:center;font-family:'jam_fontregular';font-size:41px;color:white;margin-top:153px">
			SORRY!
		</p>
		<p style="text-align:center;font-family:'TradeGothic';font-size:30px;color:white;margin-top: -21px;">
			Your Search didn't return any results
		</p>

		<a href="/videos">
			<%= image_tag "returntovideos.png" %>
		</a>
	</div>
<% end %>

		    	
<% content_for :left_side do %>

	<div class="sliderholder" style="margin-top: 102px;">
		<%= image_tag "slidepick.png", :id => "viewcontrol" %>
	</div>

	<div style="width: 75px;height: 54px;background-color: transparent;position: relative;margin-right: 485px;float: right;margin-top: -63px;cursor:pointer" onclick="Danceoff()"> </div>

	<% if request.original_url.include? "search" %>
		<div style="width: 75px;height: 54px;background-color: transparent;position: relative;margin-right: 310px;float: right;margin-top: -63px;cursor:pointer" onclick="ViewAll()"> </div>
	<% end %>

	<script type="text/javascript">

		function Danceoff()
		{
			location = "./";
		}

		function ViewAll()
		{
			location = "videos";
		}

		var temp = [200,0];

		if (window.location.href.indexOf("search") > -1)
		{
			$('#viewcontrol').css('left', '0px')
			temp = [100,0]
			$('.sliderholderright').css('display', 'none')
		}
		else
			$('#viewcontrol').css('left', '100px')


		$(function() {
		    $( "#viewcontrol" ).draggable(
		    	{ 
		    		axis: "x", 
		    		grid: temp, 
		    		containment: "parent",
		    		stop: function() 
		    		{
		    			var position = $('#viewcontrol').css('left');
				        
				        if (position == "-100px")
				        	location = "./";

				        if (position == "100px")
				        	location = "./videos";
			      	}
		    	});
		});

		

	</script>

<% end %>


<% content_for :right_side do %>
	
	<div class="searchbox">
		<input type="text" id="s_box" value="<%= @searchparam %>"/>
		<div class="gobutton" onclick="Go()"></div>
	</div>
	
	<div class="sliderholderright">
		<%= image_tag "slidepick.png", :id => "videocontrol" %>
	</div>

	<% if request.original_url.include? "pop" %>
	<div style="width: 75px;height: 54px;background-color: transparent;position: absolute;margin-left: 310px;float: left;margin-top: 114px;cursor:pointer" onclick="MostRecent()"> </div>
	<% else %>
	<div style="width: 75px;height: 54px;background-color: transparent;position: absolute;margin-left: 485px;float: left;margin-top: 114px;cursor:pointer" onclick="MostPopular()"> </div>
	<% end %>

	<script type="text/javascript">

		function MostRecent()
		{
			location = "./videos"
		}

		function MostPopular()
		{
			location = "?pop"
		}

		$(function() {
		    $( "#videocontrol" ).draggable(
		    	{ 
		    		axis: "x", 
		    		grid: [ 200, 0 ], 
		    		containment: "parent",
		    		stop: function() 
		    		{
		    			var position = $('#videocontrol').css('left');

		    			if(position != "-100px")
		    				location = "?pop"
		    			else
		    				location = "./videos"

			      	}
		    	});
		});

		function Go()
		{
			location = "./videos?search=" + $('#s_box').val()
		}

		$('#videocontrol').css('top', '6px')
		$('#videocontrol').css('left', '-100px')

		if (location.href.indexOf("pop") > -1)
			$('#videocontrol').css('left', '100px')

		if (window.location.href.indexOf("search") > -1)
			$('.sliderholderright').css('display', 'none')

	</script>

<% end %>

<script>
	$('.scrollable').perfectScrollbar();

 	$(window).bind("load", function() {
       $.getScript('assets/social.js', function() {});
    });
</script>

